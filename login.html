<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Buktiku - Login</title>
  <style>
    body {font-family:Arial,sans-serif;background:#f0f2f5;margin:0;padding:20px;display:flex;justify-content:center;align-items:center;min-height:100vh;}
    .container {background:white;padding:30px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.1);width:100%;max-width:400px;}
    h1 {text-align:center;color:#333;margin-bottom:20px;}
    input {width:100%;padding:12px;margin:10px 0;border:1px solid #ccc;border-radius:6px;box-sizing:border-box;}
    button {width:100%;padding:14px;background:#007bff;color:white;border:none;border-radius:6px;font-size:16px;cursor:pointer;margin-top:10px;}
    button:hover {background:#0056b3;}
    .back {display:block;text-align:center;margin-top:20px;color:#007bff;text-decoration:none;}
    #message {margin-top:15px;padding:10px;border-radius:6px;text-align:center;}
    .success {background:#d4edda;color:#155724;}
    .error {background:#f8d7da;color:#721c24;}
  </style>
</head>
<body>
<div class="container">
  <h1>Login ke Buktiku</h1>
  <form onsubmit="masuk(event)">
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Password" required>
    <button type="submit">Masuk</button>
  </form>
  <a href="register.html" class="back">Belum punya akun? Daftar</a>
  <div id="message"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabase = Supabase.createClient(
    'https://xrvvwyrvjwloxxvcurev.supabase.co',
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhydnZ3eXJ2andsb3h4dmN1cmV2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE0NzEwMTksImV4cCI6MjA4NzA0NzAxOX0.ZgC-oi8RaqKK4tkzPpECO_fOUUMUqFpl0p6oxkXMJK8'
  );

  async function masuk(e) {
    e.preventDefault();
    const msg = document.getElementById('message');
    msg.textContent = 'Memproses login...'; msg.className = '';

    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;

    const { error } = await supabase.auth.signInWithPassword({ email, password });

    if (error) {
      msg.textContent = error.message || 'Login gagal'; msg.className = 'error';
    } else {
      msg.textContent = 'Login berhasil! Mengarahkan...'; msg.className = 'success';
      setTimeout(() => { window.location.href = 'dashboard.html'; }, 1500);
    }
  }

  // Cek kalau sudah login
  supabase.auth.getSession().then(({ data: { session } }) => {
    if (session) window.location.href = 'dashboard.html';
  });
</script>
</body>
</html>